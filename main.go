package main

import (
	"context"
	"distributed-worker/core"
	"distributed-worker/proto/job"
	"distributed-worker/proto/task"
	"distributed-worker/service"
	"encoding/json"
	"flag"
	"fmt"
	"time"

	"github.com/ppkg/kit"
	"google.golang.org/grpc"
)

var (
	port        = flag.Int("port", 50051, "TCP port for this node")
	isSubmitJob = flag.Bool("isSubmitJob", false, "is commit job")
)

func main() {
	flag.Parse()

	app := core.NewApp(core.WithAppNameOption("distributed-worker"), core.WithPortOption(*port), core.WithSchedulerUrlOption("127.0.0.1:5001"))
	app.RegisterPlugin(core.NewPlus()).RegisterPlugin(core.NewMulti()).RegisterGrpc(func(appCtx *core.ApplicationContext, server *grpc.Server) {
		task.RegisterTaskServiceServer(server, service.NewTaskService(appCtx))
	})

	if *isSubmitJob {
		go submit(app)
	}

	err := app.Run()
	if err != nil {
		fmt.Println("got err:", err)
	}
}

func submit(ctx *core.ApplicationContext) {
	time.Sleep(10 * time.Second)
	startTime := time.Now()
	fmt.Println("开始创建任务...", "创建时间", startTime.Format("2006-01-02 15:04:05"))
	client := job.NewJobServiceClient(ctx.GetMasterConn())
	req, err := client.SyncSubmit(context.Background())
	if err != nil {
		fmt.Println("请求SyncSubmit出错 ", err)
		return
	}
	data := []map[string]interface{}{
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
	}
	for _, item := range data {
		req.Send(&job.SyncSubmitRequest{
			Name: "plus-test",
			Type: "plusJob",
			PluginSet: []string{
				"plus",
				"multi",
			},
			Data: kit.JsonEncode(item),
		})
	}

	resp, err := req.CloseAndRecv()
	if err != nil {
		fmt.Println("获取结果异常-->", err)
		return
	}
	endTime := time.Now()
	fmt.Println("完成任务...", "完成时间", startTime.Format("2006-01-02 15:04:05"), "耗时：", endTime.Sub(startTime).Seconds(), "秒")
	fmt.Printf("请求处理成功：jobId->%d，处理状态：%d，响应结果：%s\n", resp.Id, resp.Status, resp.Result)
	var list []resultRsp
	json.Unmarshal([]byte(resp.Result), &list)
	var result int
	for _, item := range list {
		result += item.Result
	}
	fmt.Println("最终计算结果：", result)

}

type resultRsp struct {
	Result int
}
