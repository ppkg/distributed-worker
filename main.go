package main

import (
	"context"
	"distributed-worker/core"
	"distributed-worker/proto/job"
	"distributed-worker/proto/task"
	"distributed-worker/service"
	"encoding/json"
	"flag"
	"fmt"
	"time"

	"github.com/ppkg/kit"
	"google.golang.org/grpc"
)

var (
	port        = flag.Int("port", 50051, "TCP port for this node")
	isSubmitJob = flag.Bool("isSubmitJob", false, "is commit sync job")
	isAsyncJob  = flag.Bool("isAsyncJob", false, "is commit async job")
)

func main() {
	flag.Parse()

	app := core.NewApp(core.WithAppNameOption("distributed-worker"), core.WithNacosSchedulerServiceNameOption("distributed-scheduler"), core.WithNacosAddrOption("mse-e52dbdd6-p.nacos-ans.mse.aliyuncs.com:8848"), core.WithNacosNamespaceOption("27fdefc2-ae39-41fd-bac4-9256acbf97bc"), core.WithNacosServiceGroupOption("my-service"), core.WithPortOption(*port))
	app.RegisterPlugin(func(ctx *core.ApplicationContext) core.PluginHandler {
		return core.NewPlus()
	}).RegisterPlugin(func(ctx *core.ApplicationContext) core.PluginHandler {
		return core.NewMulti()
	}).RegisterGrpc(func(appCtx *core.ApplicationContext, server *grpc.Server) {
		task.RegisterTaskServiceServer(server, service.NewTaskService(appCtx))
	})

	if *isSubmitJob {
		go syncSubmit(app)
	}

	if *isAsyncJob {
		go asyncSubmit(app)
	}

	err := app.Run()
	if err != nil {
		fmt.Println("got err:", err)
	}
}

func syncSubmit(ctx *core.ApplicationContext) {
	time.Sleep(10 * time.Second)
	startTime := time.Now()
	fmt.Println("开始创建同步任务...", "创建时间", startTime.Format("2006-01-02 15:04:05"))
	client := job.NewJobServiceClient(ctx.GetLeaderConn())
	req, err := client.SyncSubmit(context.Background())
	if err != nil {
		fmt.Println("请求SyncSubmit出错 ", err)
		return
	}
	data := []map[string]interface{}{
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
	}
	for _, item := range data {
		req.Send(&job.SyncSubmitRequest{
			Name: "sync-job-test",
			PluginSet: []string{
				"plus",
				"multi",
			},
			Data: kit.JsonEncode(item),
		})
	}

	resp, err := req.CloseAndRecv()
	if err != nil {
		fmt.Println("获取结果异常.......................-->", err)
		return
	}
	endTime := time.Now()
	fmt.Println("完成任务...", "完成时间", startTime.Format("2006-01-02 15:04:05"), "耗时：", endTime.Sub(startTime).Seconds(), "秒")
	fmt.Printf("请求处理成功：jobId->%d，处理状态：%d\n", resp.Id, resp.Status)
	var list []resultRsp
	json.Unmarshal([]byte(resp.Result), &list)
	var result int
	for _, item := range list {
		result += item.Result
	}
	fmt.Println("最终计算结果：", result)

}

func asyncSubmit(ctx *core.ApplicationContext) {
	time.Sleep(10 * time.Second)
	startTime := time.Now()
	fmt.Println("开始创建异步任务...", "创建时间", startTime.Format("2006-01-02 15:04:05"))
	client := job.NewJobServiceClient(ctx.GetLeaderConn())
	req, err := client.AsyncSubmit(context.Background())
	if err != nil {
		fmt.Println("请求AsyncSubmit出错 ", err)
		return
	}
	data := []map[string]interface{}{
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
		{
			"a": 1,
			"b": 2,
		},
	}
	for _, item := range data {
		req.Send(&job.AsyncSubmitRequest{
			Name: "async-job-test",
			Type: "plusJob",
			PluginSet: []string{
				"plus",
				"multi",
			},
			Data:     kit.JsonEncode(item),
			IsNotify: true,
		})
	}

	resp, err := req.CloseAndRecv()
	if err != nil {
		fmt.Println("获取结果异常-->", err)
		return
	}
	endTime := time.Now()
	fmt.Println("任务提交完成...", "完成时间", startTime.Format("2006-01-02 15:04:05"), "耗时：", endTime.Sub(startTime).Seconds(), "秒")
	fmt.Printf("请求处理成功：jobId->%d\n", resp.Id)

}

type resultRsp struct {
	Result int
}
